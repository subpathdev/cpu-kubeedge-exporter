language: go

sudo: required
dist: disco

go:
        - 1.12

before_script:
        - curl -sfL https://install.goreleaser.com/github.com/golangci/golangci-lint.sh | BINARY=golangci-lint sh -s -- -d -b $(go env GOPATH)/bin v1.16.0
        - mkdir -p $HOME/gopath/src/github.com/kubeedge/kubeedge
        - rsync -az ${TRAVIS_BUILD_DIR}/ $HOME/gopath/src/github.com/kubeedge/kubeedge/
        - export TRAVIS_BUILD_DIR=$HOME/$GOPATH/src/github.com/subpathdev/cpu-kubeedge-exporter
        - sudo apt-get install build-essential yamllint
        - export PATH=$PATH:$HOME/$GOPATH/bin

install: true

jobs:
        include:
                - stage: "Build Test"
                  script: make
                  name: "build"
                - stage: "Lint"
                  script: make lint
                  name: "check style"
